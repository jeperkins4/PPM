Overview

ForceUppercase is a plugin that provides the capabilities to automagically convert all ActiveRecord column objects of type :string or :text to their uppercase (upcase) version, as long as they have content (nil values will remain nil).

The determination is made by querying all the columns of the AR model's class for their type. Note that SQLLite returns type :string for SQL columns of type CHAR, VARCHAR, and TEXT.

Installation

To install the ForceUppercase plugin into a current Rails application, run the script/plugin script from the root of our application passing it the URL of svn://rubyforge.org//var/svn/force-uppercase
For example:

script/plugin install svn://rubyforge.org//var/svn/force-uppercase

Once installed you will need to restart your webserver for the plugin to be loaded into the Rails environment.

Syntax

The syntax is easy. Simply add a class method to your ActiveRecord class definition as follows:

  force_uppercase optional_arguments

  where optional_arguments is one or more of the following options, separated by commas (,):
  
    :include_text => true|false  - Indicates whether or not to convert to uppercase columns of type TEXT (note SQLLite limitation described above)

    :only => column_definition   - Indicates that only the specified columns should be converted to uppercase

    :except => column_definition - Indicates that all :string columns EXCEPT for the ones included in this option should be converted to uppercase (this will not convert columns of type TEXT unless the :include_text option is included)

  where column_definition is a column name or an array of column names

Usage

To convert all columns of type string to uppercase

  class Person < ActiveRecord::Base
    force_uppercase
  end

To convert all columns of type string AND text to uppercase

  class Person < ActiveRecord::Base
    force_uppercase, :include_text => true
  end

To convert only certain columns (it will verify that the columns are of type :string or :text)

  class Person < ActiveRecord::Base
    force_uppercase, :only => [ :first_name, :last_name, :age ]
  end

  Where column age (assuming it's integer) will silently be ignored

To convert all but certain columns (not including TEXT column types)

  class Person < ActiveRecord::Base
    force_uppercase, :except => [ :title, :suffix ]
  end
